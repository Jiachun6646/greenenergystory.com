<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Color and Word Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f0f0;
        }
        #gameContainer {
            width: 100%;
            max-width: 600px;
            text-align: center;
        }
        #startScreen, #gameScreen, #endScreen {
            display: none;
        }
        #startScreen.active, #gameScreen.active, #endScreen.active {
            display: block;
        }
        #startTitle {
            color: red;
            font-size: 48px;
            font-weight: bold;
            margin-bottom: 20px;
        }
        #startDescription {
            color: black;
            font-size: 20px;
            margin-bottom: 20px;
        }
        #startButton, .tryAgainButton {
            background-color: #87CEFA;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 24px;
            cursor: pointer;
            margin-top: 20px;
        }
        #progressBar {
            width: 100%;
            height: 2px;
            background-color: blue;
        }
        #keywordDisplay {
            font-size: 48px;
            font-weight: bold;
            margin: 20px 0;
        }
        #gridContainer {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
        }
        .gridCell {
            border: 0.5px solid blue;
            border-radius: 10px;
            padding: 15px;
            font-size: 30px;
            color: black;
            cursor: pointer;
        }
        #failureScreen {
            text-align: center;
        }
        #failureMessage {
            font-family: 'Microsoft YaHei', sans-serif;
            color: red;
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 20px;
        }
        #scoreMessage {
            font-family: 'Microsoft YaHei', sans-serif;
            color: blue;
            font-size: 36px;
            margin-bottom: 20px;
        }
        #successScreen {
            text-align: center;
        }
        #successMessage {
            font-family: 'Microsoft YaHei', sans-serif;
            color: red;
            font-size: 48px;
            font-weight: bold;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <!-- 开始界面 -->
        <div id="startScreen" class="active">
            <div id="startTitle">Click the Color not the Word</div>
            <div id="startDescription">20 levels. Increasing distractions. Against the clock. All you have to do: click the colour and not the word</div>
            <button id="startButton">START PLAY</button>
        </div>

        <!-- 游戏界面 -->
        <div id="gameScreen">
            <div id="progressBar"></div>
            <div id="keywordDisplay">Red</div>
            <div id="gridContainer"></div>
        </div>

        <!-- 游戏失败界面 -->
        <div id="failureScreen">
            <div id="failureMessage">Sorry, You Failed !</div>
            <div id="scoreMessage">Your Score is 0</div>
            <button class="tryAgainButton">Try again</button>
        </div>

        <!-- 游戏成功界面 -->
        <div id="successScreen">
            <div id="successMessage">Congratulations. You made it through all the levels !</div>
            <button class="tryAgainButton">Try again</button>
        </div>
    </div>

    <script>
        const COLORS = ['Red', 'Blue', 'Green', 'Yellow', 'Black', 'Purple', 'Pink', 'Brown', 'Gray'];
        const VALID_COLORS = {
            'Red': '#FF0000', 
            'Blue': '#0000FF', 
            'Green': '#00FF00', 
            'Yellow': '#FFFF00', 
            'Black': '#000000', 
            'Purple': '#800080', 
            'Pink': '#FFC0CB', 
            'Brown': '#A52A2A', 
            'Gray': '#808080'
        };

        class AttentionGame {
            constructor() {
                this.currentLevel = 1;
                this.score = 0;
                this.totalLevels = 20;
                this.gameTime = 6;

                this.startScreen = document.getElementById('startScreen');
                this.gameScreen = document.getElementById('gameScreen');
                this.failureScreen = document.getElementById('failureScreen');
                this.successScreen = document.getElementById('successScreen');
                this.progressBar = document.getElementById('progressBar');
                this.keywordDisplay = document.getElementById('keywordDisplay');
                this.gridContainer = document.getElementById('gridContainer');
                this.scoreMessage = document.getElementById('scoreMessage');

                this.bindEvents();
            }

            bindEvents() {
                document.getElementById('startButton').addEventListener('click', () => this.startGame());
                document.querySelectorAll('.tryAgainButton').forEach(btn => {
                    btn.addEventListener('click', () => this.resetGame());
                });
            }

            startGame() {
                this.startScreen.classList.remove('active');
                this.gameScreen.classList.add('active');
                this.setupLevel();
            }

            setupLevel() {
                // 随机选择关键词和颜色
                const keywordColor = this.getRandomColor();
                const textColor = this.getRandomColorExcept(keywordColor);
                const gridColors = this.shuffleArray(COLORS.slice());

                // 设置显示的关键词和颜色
                this.keywordDisplay.textContent = keywordColor;
                this.keywordDisplay.style.color = VALID_COLORS[textColor];

                // 清空并重新创建九宫格
                this.gridContainer.innerHTML = '';
                gridColors.forEach(color => {
                    const cell = document.createElement('div');
                    cell.classList.add('gridCell');
                    cell.textContent = color;
                    cell.addEventListener('click', () => this.checkAnswer(color, keywordColor, textColor));
                    this.gridContainer.appendChild(cell);
                });

                // 开始计时器
                this.startTimer();
            }

            startTimer() {
                const progressBar = this.progressBar;
                progressBar.style.width = '100%';
                
                let remainingTime = this.gameTime;
                const interval = setInterval(() => {
                    remainingTime -= 0.1;
                    const percentage = (remainingTime / this.gameTime) * 100;
                    progressBar.style.width = `${percentage}%`;

                    if (remainingTime <= 0) {
                        clearInterval(interval);
                        this.gameOver(false);
                    }
                }, 100);
            }

            checkAnswer(selectedColor, keywordColor, textColor) {
                if (selectedColor === textColor) {
                    this.levelUp();
                } else {
                    this.gameOver(false);
                }
            }

            levelUp() {
                this.currentLevel++;
                this.score += Math.pow(2, this.currentLevel - 1);
                this.gameTime -= 0.25;

                if (this.currentLevel > this.totalLevels) {
                    this.gameOver(true);
                } else {
                    this.setupLevel();
                }
            }

            gameOver(isSuccess) {
                this.gameScreen.classList.remove('active');
                
                if (isSuccess) {
                    this.successScreen.classList.add('active');
                } else {
                    this.failureScreen.classList.add('active');
                    this.scoreMessage.textContent = `Your Score is ${this.score}`;
                }
            }

            resetGame() {
                this.currentLevel = 1;
                this.score = 0;
                this.gameTime = 6;

                this.failureScreen.classList.remove('active');
                this.successScreen.classList.remove('active');
                this.startScreen.classList.add('active');
            }

            getRandomColor() {
                return COLORS[Math.floor(Math.random() * COLORS.length)];
            }

            getRandomColorExcept(excludeColor) {
                const availableColors = COLORS.filter(color => color !== excludeColor);
                return availableColors[Math.floor(Math.random() * availableColors.length)];
            }

            shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }
        }

        // 初始化游戏
        new AttentionGame();
    </script>
</body>
</html>
